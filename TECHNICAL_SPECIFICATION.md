# RyugakuTalk 技術要件書・現状進捗・移行計画

## 📋 プロジェクト概要

**プロジェクト名**: RyugakuTalk（留学支援Webプラットフォーム）  
**目的**: 留学中・留学希望者・関係者が質問・共有・交流できる安全なオンラインコミュニティ  
**開発段階**: MVP完成 → 本番環境移行準備中

---

## 🎯 技術要件

### 現行技術スタック

| 分類 | 技術 | バージョン | 備考 |
|------|------|-----------|------|
| **フロントエンド** | React | 18 | UI構築 |
| **フレームワーク** | Next.js | 14.0.4 | SSR・ルーティング |
| **言語** | TypeScript | 5 | 型安全性 |
| **UIライブラリ** | Tailwind CSS | 3.3.0 | スタイリング |
| **データベース** | PostgreSQL | (Supabase経由) | リレーショナルDB |
| **認証** | Supabase Auth | 2.38.4 | ユーザー認証 |
| **多言語対応** | i18next | 23.7.6 | 日本語・英語 |
| **デプロイ環境** | Vercel | - | 現在のホスティング |

### 移行先技術要件

| 分類 | 要件 | 備考 |
|------|------|------|
| **サーバー** | レンタルサーバー（2ヶ月間） | 共同開発者が確保済み |
| **データベース** | SQL（MySQL/MariaDB/PostgreSQL） | レンタルサーバーで利用可能なDB |
| **Webサーバー** | Apache/Nginx | レンタルサーバーの標準設定 |
| **Node.js** | 18以上 | Next.js 14の要件 |
| **HTTPS** | SSL証明書 | 必須（セキュリティ） |
| **ドメイン** | 任意 | レンタルサーバーで設定可能 |

---

## ✅ 現状の進捗状況

### 実装完了機能（MVP）

#### 1. 認証システム ✅
- [x] メールアドレスでの新規登録・ログイン
- [x] プロフィール自動作成
- [x] セッション管理
- [x] ログアウト機能
- [ ] Google OAuth（一旦無効化）

**実装ファイル**:
- `src/app/auth/signin/page.tsx` - ログインページ
- `src/app/auth/signup/page.tsx` - 新規登録ページ
- `src/components/Providers.tsx` - 認証プロバイダー

#### 2. プロフィール機能 ✅
- [x] プロフィール表示
- [x] プロフィール編集
- [x] 貢献度システム（投稿+10pt、コメント+5pt）
- [x] 統計情報表示

**実装ファイル**:
- `src/app/profile/[id]/page.tsx` - プロフィール表示
- `src/app/profile/[id]/edit/page.tsx` - プロフィール編集

#### 3. 掲示板機能 ✅
- [x] 投稿作成（質問・留学日記・情報共有）
- [x] 投稿一覧表示
- [x] 投稿詳細表示
- [x] コメント機能
- [x] いいね機能
- [x] 検索・フィルタリング
- [x] カテゴリ分け

**実装ファイル**:
- `src/app/board/page.tsx` - 掲示板一覧
- `src/app/diary/page.tsx` - 留学日記専用ページ
- `src/app/posts/new/page.tsx` - 新規投稿
- `src/app/posts/[id]/page.tsx` - 投稿詳細

#### 4. チャット機能 ✅
- [x] ユーザー検索（ID・タグ）
- [x] メッセージ送受信
- [x] 会話一覧表示
- [x] 未読メッセージ数表示
- [x] リアルタイム更新（Supabase Realtime）

**実装ファイル**:
- `src/app/chat/page.tsx` - チャット一覧
- `src/app/chat/[userId]/page.tsx` - チャット詳細

#### 5. UI/UX ✅
- [x] レスポンシブデザイン（モバイル対応）
- [x] 多言語対応（日本語・英語）
- [x] ナビゲーション
- [x] エラーハンドリング

**実装ファイル**:
- `src/components/Header.tsx` - ヘッダー
- `src/components/Footer.tsx` - フッター
- `src/app/layout.tsx` - レイアウト

### データベーススキーマ

#### テーブル構成 ✅

1. **profiles** - ユーザープロフィール
   - id, email, name, university, study_abroad_destination, major, bio, languages, contribution_score

2. **posts** - 投稿
   - id, title, content, category, tags, author_id, likes_count, comments_count, is_pinned, is_resolved

3. **comments** - コメント
   - id, content, post_id, author_id, likes_count, is_solution

4. **likes** - いいね
   - id, user_id, post_id, comment_id

5. **messages** - メッセージ
   - id, sender_id, receiver_id, content, is_read

6. **reports** - 通報
   - id, reporter_id, post_id, comment_id, reason, description, status

**スキーマファイル**: `supabase-schema.sql`

### 未実装機能（将来実装予定）

- [ ] 管理機能（投稿削除・通報処理）
- [ ] 通知機能
- [ ] 画像アップロード
- [ ] メール通知
- [ ] パスワードリセット機能

---

## 🔄 レンタルサーバー移行計画

### 移行前の準備

#### 1. データベース移行
- [ ] PostgreSQLスキーマをMySQL/MariaDBに変換
- [ ] データマイグレーションスクリプト作成
- [ ] 既存データのエクスポート・インポート

#### 2. 認証システムの移行
- [ ] Supabase Authから自前認証へ移行（NextAuth.js等）
- [ ] パスワードハッシュ化の実装
- [ ] セッション管理の実装

#### 3. 環境設定
- [ ] レンタルサーバーの仕様確認
  - Node.jsバージョン
  - データベース種別（MySQL/MariaDB/PostgreSQL）
  - メモリ・CPU制限
  - ディスク容量
- [ ] 環境変数の設定
- [ ] SSL証明書の設定

### 移行作業の流れ

#### Phase 1: 環境構築（1週間）
1. レンタルサーバーへのアクセス情報取得
2. データベース作成・設定
3. Node.js環境の確認
4. ドメイン設定（必要に応じて）

#### Phase 2: コード修正（2週間）
1. データベース接続の変更（Supabase → 直接接続）
2. 認証システムの移行
3. 環境変数の更新
4. ビルド設定の調整

#### Phase 3: デプロイ・テスト（1週間）
1. レンタルサーバーへのデプロイ
2. 機能テスト
3. パフォーマンステスト
4. セキュリティチェック

#### Phase 4: データ移行（1週間）
1. 既存データのエクスポート
2. データ変換・インポート
3. データ整合性チェック

---

## 📊 今後の流れ（ロードマップ）

### 短期目標（1-2ヶ月）

#### 1. レンタルサーバー移行 ✅優先
- [ ] 環境構築
- [ ] コード修正
- [ ] デプロイ
- [ ] データ移行

#### 2. 試運転（ベータテスト）
- [ ] 内部テスト（開発チーム）
- [ ] クローズドベータ（限定ユーザー）
- [ ] バグ修正
- [ ] パフォーマンス最適化

#### 3. 正式リリース準備
- [ ] ドキュメント整備
- [ ] 利用規約・プライバシーポリシー作成
- [ ] ヘルプページ作成
- [ ] サポート体制の構築

### 中期目標（3-6ヶ月）

#### 1. ユーザー獲得
- [ ] マーケティング施策
- [ ] SNS拡散
- [ ] 大学への案内
- [ ] ユーザー招待プログラム

#### 2. 機能拡張
- [ ] 管理機能の実装
- [ ] 通知機能
- [ ] 画像アップロード
- [ ] 検索機能の強化

#### 3. 改善・最適化
- [ ] ユーザーフィードバック収集
- [ ] UI/UX改善
- [ ] パフォーマンス最適化
- [ ] セキュリティ強化

### 長期目標（6ヶ月以上）

#### 1. スケーラビリティ
- [ ] サーバー容量の拡張検討
- [ ] データベース最適化
- [ ] CDN導入検討

#### 2. 新機能開発
- [ ] AI回答機能
- [ ] 動画共有機能
- [ ] イベント機能
- [ ] マッチング機能

#### 3. 多大学展開
- [ ] 他大学への展開
- [ ] パートナーシップ構築
- [ ] ブランディング強化

---

## 🔧 技術的な課題と対策

### 課題1: Supabaseから自前DBへの移行

**課題**:
- Supabaseのリアルタイム機能に依存
- Supabase Authの認証システム

**対策**:
- データベース接続を直接PostgreSQL/MySQL接続に変更
- NextAuth.js等で認証システムを実装
- リアルタイム機能はWebSocket等で代替検討

### 課題2: レンタルサーバーの制約

**課題**:
- Node.jsバージョン制限
- メモリ・CPU制限
- データベース接続数制限

**対策**:
- サーバー仕様の事前確認
- パフォーマンス最適化
- キャッシュ戦略の実装

### 課題3: データ移行

**課題**:
- 既存データの移行
- データ整合性の確保

**対策**:
- データマイグレーションスクリプトの作成
- データバックアップの徹底
- 段階的な移行

---

## 📝 チェックリスト

### 移行前チェックリスト

- [ ] レンタルサーバーの仕様確認
- [ ] データベース種別の確認
- [ ] Node.jsバージョンの確認
- [ ] ドメイン設定の確認
- [ ] SSL証明書の設定
- [ ] 環境変数の整理

### 移行時チェックリスト

- [ ] データベーススキーマの作成
- [ ] データマイグレーション
- [ ] 認証システムの移行
- [ ] 環境変数の設定
- [ ] デプロイの実行
- [ ] 機能テスト

### リリース前チェックリスト

- [ ] 全機能の動作確認
- [ ] セキュリティチェック
- [ ] パフォーマンステスト
- [ ] バックアップ設定
- [ ] 監視体制の構築
- [ ] ドキュメント整備

---

## 👥 共同開発体制

### 役割分担（提案）

- **開発者A（現行）**: フロントエンド・UI/UX
- **開発者B（共同）**: バックエンド・サーバー管理
- **役割**: 必要に応じて調整

### コミュニケーション

- **GitHub**: コード管理・課題管理
- **ドキュメント**: 技術仕様・進捗共有
- **定例会議**: 週次で進捗確認

---

## 📞 サポート・連絡先

- **GitHubリポジトリ**: https://github.com/akinou2001/ryugaku-talk
- **技術ドキュメント**: 本ファイル
- **進捗管理**: GitHub Issues/Projects

---

**最終更新**: 2024年  
**バージョン**: 1.0  
**ステータス**: 移行準備中









