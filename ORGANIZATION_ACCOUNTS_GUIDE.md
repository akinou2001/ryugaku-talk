# 組織アカウント機能ガイド

## 📋 概要

教育機関・企業・政府機関向けのアカウント機能を実装しました。組織アカウントは公式情報を共有するために使用できます。

## 🎯 機能

### 1. アカウントタイプ

- **個人アカウント** (`individual`): 通常のユーザーアカウント
- **教育機関アカウント** (`educational`): 大学・学校などの教育機関
- **企業アカウント** (`company`): 企業・団体
- **政府機関アカウント** (`government`): 省庁・自治体などの政府機関

### 2. 認証プロセス

1. **登録**: 組織アカウントとして登録
2. **審査**: 管理者による認証審査（通常1-3営業日）
3. **認証完了**: 認証済みバッジが表示され、公式投稿が可能に

### 3. 認証ステータス

- `unverified`: 未認証（個人アカウントのデフォルト）
- `pending`: 審査中（組織アカウントのデフォルト）
- `verified`: 認証済み（公式投稿が可能）
- `rejected`: 認証拒否

### 4. 公式投稿機能

認証済みの組織アカウントのみが公式投稿を作成できます。

**公式投稿カテゴリ**:
- 奨学金情報
- イベント情報
- プログラム情報
- お知らせ
- その他

## 📝 データベーススキーマ

### 追加されたカラム

#### profilesテーブル
- `account_type`: アカウントタイプ
- `organization_name`: 組織名
- `organization_type`: 組織種別
- `organization_url`: 組織URL
- `verification_status`: 認証ステータス
- `verification_documents`: 認証用書類
- `contact_person_name`: 担当者名
- `contact_person_email`: 担当者メールアドレス
- `contact_person_phone`: 担当者電話番号

#### postsテーブル
- `is_official`: 公式投稿かどうか
- `official_category`: 公式投稿のカテゴリ

### スキーマ適用方法

```sql
-- supabase-schema-organization-accounts.sql を実行
```

SupabaseダッシュボードのSQLエディタで実行してください。

## 🚀 使用方法

### 組織アカウントの登録

1. `/auth/signup` にアクセス
2. アカウントタイプを選択（教育機関・企業・政府機関）
3. 組織情報を入力
   - 組織名（必須）
   - 組織種別
   - 組織URL
   - 担当者名（必須）
   - 担当者メールアドレス（必須）
   - 担当者電話番号
4. アカウントを作成
5. 認証審査を待つ（通常1-3営業日）

### 公式投稿の作成

1. 認証済みの組織アカウントでログイン
2. `/posts/new` にアクセス
3. カテゴリで「公式投稿」を選択
4. 「公式投稿として公開する」にチェック
5. 公式投稿カテゴリを選択
6. 投稿内容を入力して投稿

## 🎨 UI要素

### アカウントバッジ

組織アカウントには専用のバッジが表示されます：

- **教育機関**: 青いバッジ（🎓アイコン）
- **企業**: 緑のバッジ（💼アイコン）
- **政府機関**: 紫のバッジ（🛡️アイコン）

認証済みの場合はチェックマーク（✓）が表示されます。

### 表示場所

- プロフィールページ
- 投稿一覧
- 投稿詳細ページ
- コメント欄

## 🔒 セキュリティ

### RLSポリシー

- 組織アカウントは自分のプロフィールを更新可能
- 認証済み組織アカウントのみ公式投稿を作成可能
- 認証申請は申請者のみ閲覧可能

### 認証管理

認証申請は `organization_verification_requests` テーブルで管理されます。
管理者が審査を行い、認証ステータスを更新します。

## 📊 今後の拡張

- [ ] 認証申請管理画面
- [ ] 認証書類アップロード機能
- [ ] 公式投稿の特別表示
- [ ] 組織アカウント専用ダッシュボード
- [ ] 統計・分析機能

## 🐛 トラブルシューティング

### 認証が完了しない

- 認証ステータスを確認（プロフィールページ）
- 管理者に問い合わせ

### 公式投稿が作成できない

- 認証ステータスが `verified` か確認
- アカウントタイプが `individual` でないか確認

### バッジが表示されない

- ブラウザのキャッシュをクリア
- プロフィール情報を再読み込み

